<!DOCTYPE html>
<html>
<head>
  <title>Labrador: 关于按键绑定</title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="../../../application.css">
</head>

<body class="projects messages">
  <header>
    <nav class="global">
      <a href="../../../index.html" class="home">Home</a> |
      <a href="../../../projects/index.html" class="projects">Projects</a> |
      <a href="../../../calendars/index.html" class="calendars">Calendars</a> |
      <a href="../../../people/index.html" class="people">People</a>
    </nav>

    <header>
      <h1>Labrador</h1>
    </header>

      <nav><a href="../topics/index.html">&larr; See all discussions</a></nav>
  </header>

  
<article class="message">
  <header>
    <h2>关于按键绑定</h1>
    <p>Posted by 鹏 孙 on June 12, 2012</p>
  </header>

  <div class="content">
    <div>由于系统中大量使用按键绑定，如果将js的功能实现与绑定放到相同的文件中，可能会造成文件过于庞大，故而无法修改。为了解决这个问题，我决定在按键绑定这里使用动态绑定的方式。</div><div><br></div><div>在github中我提交了现在完成的一个版本，基本原理非常简单，使用两个文件，分别是keybinding.js和keybinding.config.js，其中keybinding.config.js使用js的对象记录一个键值对，键是第三个按键的keyCode（第一、二个按键分别是ctrl+shift），值是对应操作具体执行的js代码的方法，这个方法可以在不同的文件之中。</div><div><br></div><div>这样的设计目前可以我想到的弊端包括两个：</div><div>1.前两个键位固定。为了解决这个问题，可以将keybinding.config.js里面的键增加一些前缀，在匹配的时候进行解析。</div><div>2.调用的方法不能包含参数。这个问题比较紧迫，但是目前没有想好怎么处理，也就是如何获得请求参数（快捷键调用的方法可能不需要请求参数吧）。</div><div><br></div><div>这种设计还有其他的问题么？</div><div><br></div><div>请各位给点意见啊！</div>
  </div>

  
    <div class="comments">
    <h3>Comments</h3>

      <div class="comment">
        <p><b>HONGFENG ZHANG</b> on June 13, 2012:</p>

        <div class="content">
          你的设计我赞同。要解决第二个问题，考虑增加一层：<br><br>可以建一个单独的文件，比如：<pre>actions.js
</pre><br>里面有很多无参数的函数，视作多个Action，界面按钮和键盘的事件都指向里面的函数，比如有：<br><pre>makePageWide()
makePageNormal()
makePageNarrow()
</pre><br>这三个函数分别调用<br><pre>setContentWidth(contentWidth)
</pre><br>传递不同参数0,1,2，这样也比较清晰。<br><br>还有一个办法就是不用参数，函数内获取状态，比如：<br><pre>setNextStyle()</pre><pre>setPrevStyle()
</pre><br>执行时先调用：<pre>getCurrentStyle()</pre><span><br>再或者模仿launchctl的设计，把命令行设计成一个列表类型，每个参数都是一个item。<br><br>不知道我是否理解了你的问题。<br></span><pre><br></pre><pre> </pre><br><br><pre> </pre><br><pre> </pre><br><pre> </pre><pre> </pre>
        </div>

        
      </div>
      <div class="comment">
        <p><b>鹏 孙</b> on June 13, 2012:</p>

        <div class="content">
          我明白张总的设计思路，就是通过额外的抽象来减少代码的重复量，这个设计我可以考虑使用！
        </div>

        
      </div>
  </div>

</article>

</body>

</html>
