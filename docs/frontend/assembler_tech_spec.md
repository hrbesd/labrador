# 组装器技术文档

## 功能

组装器完成的是从xml文件生成对应网站内容的工具，将xml中的内容字段与网站的模板组合起来。

此外，组合器还需要完成文章列表的分页功能，可以根据不同的设备、分辨率的需求，生成不同的分页内容，同时保证分页的内容可访问。


## 模板系统

模板的功能是实现前台表现和后台数据的分离。在后台数据保持稳定的情况下，可以通过修改前端少量的代码，来完成整个网站的大量网页生成工作，使前后台解耦合。

要实现的基本功能包括：

- 变量替换：在xml中定义的元素的内容，可以根据模板中的标签进行替换。
- 循环结构：能够实现基本的循环结构来填充数据。
- 判断结构：提供简单的if/else判断，满足某种条件的时候，才显示某些动作。


## 分页功能

后端的分析器可以提供整个网站的栏目，以及栏目下面的文章列表。有的栏目对应的子文章可能有很多，这样可能导致页面过长，所以需要分页。

与此同时，不同设备由于分辨率、尺寸不同，所以每页显示的数据量可能也不尽相同，因此需要实现根据不同的配置来进行分页。

在分页器部分需要完成的功能包括：

- 分页配置：可以读取配置文件，根据配置文件来生成网站。配置文件使用xml格式，没一套网站是一个xml节点，这个节点包括两个子节点，分别对应，每页显示栏目数目（正整数），以及目标路径（字符串）。
- 分页功能：能够提供下一页、上一页等基本按钮，同时能够根据实际文章的内容来动态调整是否显示上一页、下一页。这里的所有连接都要有效。
- 分页URL定义：为了满足连接跳转可以正常使用，在生成分页的时候，需要同时生成对应的目标URL，也就是最终网页的名称。
- 原始分页节点的记录
  * parser输出的数据中，会包含原始节点的分页信息
  * 原始分页信息采用自定义的`page`标签保存，定义了额外的`num`属性
  * `num`属性用于记录当前是哪个页面，如`num=1`，表示当前是原始页面的第一页
  * `page`标签内的内容就是原始网站中一个页面的内容
  * 如果页面内容没有原始分页，为了保持统一性，仍然添加`page`标签

## 文件生成

- 文件生成使用单层结构，文件名称使用原始页面完整URL地址的hash值
- 最终的访问URL地址构成：```改造之后的网站URL + <页面hash>.html```